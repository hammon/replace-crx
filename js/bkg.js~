
//"http://*/*",
//"https://*/*",

var activetTabId = null;

chrome.browserAction.onClicked.addListener(function(tab) {

	console.log("Hello from replace");

	chrome.tabs.executeScript({
		file : 'js/script.js',
				//code: "alert('aaaaaaaa');Ext.Msg.alert('Status', 'Changes saved successfully.');",
		allFrames : true
	});


		//chrome.tabs.create({url:chrome.extension.getURL('main.html')}, function (tab){
					//console.log("chrome.browserAction.onClicked chrome.tabs.create " + tab.id);
					//sessionInfo.keywordsTabId = tab.id;
		//		});
});

chrome.tabs.onActivated.addListener(function (info){
	var prevTabId = activetTabId;
	activetTabId = info.tabId;
	console.log("tabs.onActivated prevTabId: " + prevTabId + " activetTabId: " + activetTabId);
});

/*
chrome.webRequest.onCompleted.addListener(
	function(details){
		console.log("onCompleted: " + JSON.stringify(details));
	},
	{urls: ["<all_urls>"]}
);
*/



var conextId = chrome.contextMenus.create(
	{
		"title": "Replace", 
		"contexts":["selection"],
                "onclick": function(info, tab){
			console.log(info.selectionText);
			chrome.tabs.query(
				{
					active: true, 
					currentWindow: true
				}, 
				function(tabs) {															  						chrome.tabs.sendMessage(
					tabs[0].id, {greeting: info.selectionText}, function(response){
						console.log(response.farewell);
					});
				}
			);
			//var res = promt("replace " + info.selectionText);
			//alert(res);


		}
	}
);
